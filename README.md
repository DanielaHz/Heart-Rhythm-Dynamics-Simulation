# Heart Rhythm Dynamics Simulation Using a Three-Coupled Oscillator Model

![img](/images/humanheart.png)

The present project aims to simulate the dynamics of a human heart using the three-coupled oscillator model proposed in the paper of the same name. Since the heart is a soft body, I will use the Jelly Engine as the boilerplate for this assessment.

## Current Approach 

Soft body meshes requires representing it as a system of mass points connected by springs. Originally, Jelly Engine generated these springs exponentially relative to the number of mesh vertices, connecting each point to others within a certain distance. While inefficient, this method worked for simple models because it created an apparent volume from the mesh surface, forcing the structure to behave elastically and maintain a shape—even though .obj files only contain surface information.

The issue is that this approach to estimating volume and filling it with springs does not scale well with higher-resolution meshes. As complexity increases, real-time simulations become unstable and often crash. To address this, I aimed to improve how volume is generated by using tetrahedralization—a common practice in real-time soft body simulation—to create an internal structure that is both more stable and computationally efficient.

Therefore, the current simulation approach focuses on supporting more complex meshes through the use of tetrahedral meshes, which define a real, volumetric structure suitable for simulation. This volumetric representation can then be processed within Jelly Engine to generate the soft body required for physical modeling.

## Demo Current approach

link to Demo: https://youtu.be/IsaZODWU3jo?si=4awjXmyYkVD8-DmH

## Execution 

Build the project
```
mkdir build 
cd build 
cmake -DCMAKE_BUILD_TYPE=Release -B out .
```

Execute the project
```
cd ..
cmake --build out

cd build/Game
./Game
```
## Three-Coupled Oscillator Model

The normal cardiac rhythm is primarily generated by the SA node, the heart’s natural pacemaker, although the AV node also functions as a secondary pacemaker. Each produces an activation potential that contributes to the heart’s dynamics, though not all are equally reflected in the ECG signal. Activation waves from different regions (atria and ventricles) produce electrical currents of varying magnitudes, and their combination shapes the ECG signal.

Initially, two coupled oscillators are used to represent the SA and AV nodes. However, this is insufficient to fully reproduce the ECG, particularly the QRS complex, which corresponds to ventricular repolarization.

To address this, a third oscillator is introduced to represent the His–Purkinje system, responsible for conducting the pulse through the ventricles. The full conceptual model includes asymmetric bidirectional coupling between all oscillators, along with external periodic excitations, forming a system represented by differential equations.

### Heart Zones

![image](/images/HeartModel1.png)

### Model Division

![image](/images/ColorSection2.png)

| Name | Color Name | RGB Value |
| --- | --- | --- |
| SA Node | Blue | (1.000, 0.401, 0.839) |
| AV Node | Purple | (0.602, 0.253, 1.000) |
| HPC | Pink | (0.270, 0.604, 1.000) |

### Data to simulate
In the thesis titled "Las matemáticas de la fisiología del corazón", the authors simulate a human heart electrocardiogram and use that data for their analysis. I will use the same approach to achieve the best possible results.

| SA Node | AV Node | HCP Node |
| --- | --- | --- |
| sa.a = 3 | av.a = 3 | hcp.a = 5 |
| sa.w1 = 0.2 | av.w1 = 0.1 | hcp.w1 = 1 |
| sa.w2 = -1.9 | av.w2 = -0.1 | hcp.w2 = -1 |
| sa.d = 3 | av.d = 3 | hcp.d = 3 |
| sa.e = 4.9 | av.e = 3 | hcp.e = 7 |
| sa.omega = 0 | av.omega = 0 | hcp.omega = 0 |
| sa.q  = 1 | av.q = 1| hcp.q = 20 |
| sa.kSA_to_kAV = 0  | av.kAV_to_kSA = 5 | hcp.kHPC_to_kSA = 0 |
| sa.kSA_to_kHPC  = 0 | av.kAV_to_kHPC = 0 | hcp.kHPC_to_kAV = 20 |
| a0  = 1 | a1 = 0.1| a3 = 0.05 |
| a5 = 0.4 |  |  |

## Resources 

- https://github.com/Rafapp/jellyengine/blob/main/build.bat
- http://mecanon.coppe.ufrj.br/wp-content/uploads/2017/11/Heart-Rhythms_ChaosSolFractals09.pdf
- https://uvadoc.uva.es/bitstream/handle/10324/36037/TFG-G3546.pdf?sequence=1&isAllowed=y
- https://www.youtube.com/watch?v=j-8zfz-E73c&t=2269s&ab_channel=InsideLivermoreLab
- https://www.fab.com/listings/30c310b0-8317-4e92-a9dd-42a55046da6b
-
